from sklearn.base import BaseEstimator, TransformerMixin
NUMERICAL_VARS = ['pclass','age','sibsp','parch','fare']

class MissingIndicator(BaseEstimator, TransformerMixin):
    
    def __init__(self, variables=None):
        if not isinstance(variables, list):
            self.variables = [variables]
        else:
            self.variables = variables
    
    def fit(self, X, y=None):
        return self
    
    def transform(self, X):
        X = X.copy()
        for var in self.variables:
            X[var+'_nan'] = X[var].isnull().astype(int)
        
        return X
    
    
create_missing_flag = MissingIndicator(variables=NUMERICAL_VARS)
X_train = create_missing_flag.transform(X_train)
X_test = create_missing_flag.transform(X_test)